NEI <- readRDS("summarySCC_PM25.rds")
nei <- NEI
rm(NEI)
head(nei)
scc <- readRDS("Source_Classification_Code.rds")
scc
head(scc)
str(scc)
str(nei)
year <- nei$year
pm25 <- nei$Emissions
plot(year,pm25)
tapply(nei, year, sum)
tapply(nei, 2, sum)
tapply(pm25, year, sum)
plot(tapply(pm25, year, sum))
?plot
t(tapply(pm25, year, sum))
tb <- tapply(pm25,year,sum)
tb
t(tb)
t(tb)
swril()
library(swirl)
swirl()
pm0
dim(pm0)
head(pm0)
cnames
cnames <- strsplit(cnames, '|', fixed = TRUE)
cnames
names(pm0) <- cnames[[1]][wcol]
names(pm0) <- make.cnames[[1]][wcol]
names(pm0) <- make.names(cnames[[1]][wcol])
head(pm0)
x0 <- pm0$Sample.Value
str(x0)
mean(is.na(x0))
names(pm1) <- make.names(cnames[[1]][wcol])
dim(pm1)
x1 <- pm1$Sample.Value
mean(is.na(x1))
summary(x0)
summary(pm1)
summary(x1)
boxplot(x0,x1)
boxplot(log10(x0),log10(x1))
x1<0
negative <- x1<0
sum(negative, na.rm = TRUE)
mean(negative, na.rm = TRUE)
dates <- pm1$Date
str(dates)
dates <- as.Date(as.charater(dates),%Y%m%d)
dates <- as.Date(as.charater(dates),%Y%m%d)
dates <- as.Date(as.charater(dates),'%Y%m%d')
dates <- as.Date(as.character(dates),'%Y%m%d')
head(dates)
hist(dates[negative],month)
hist(dates[negative],'month')
str(site0)
intersect(site0, site1)
both <- intersect(site0, site1)
both
head(pm0)
cnt0 <- subset(pm0, State.site == 36, county.site == both)
cnt0 <- subset(pm0, pm0$State.site == 36, pm0$county.site == both)
cnt0 <- subset(pm0, pm0$State.site == 36, pm0$county.site in both)
cnt0 <- subset(pm0, pm0$State.site == 36)
cnt0 <- subset(pm0, pm0$State.site == 36 & county.site %in% both)
cnt0 <- subset(pm0, State.site == 36 & county.site %in% both)
cnt0 <- subset(pm0, State.code == 36 & county.site %in% both)
cnt0 <- subset(pm0, State.Code == 36 & county.site %in% both)
cnt1 <- subset(pm1, State.Code == 36 & county.site %in% both)
cnt0
sapply(split(cnt0, cnt0$county.site), nrow)
sapply(split(cnt1, cnt1$county.site), nrow)
pm0sub <- subset(cnt0, County.Code == 63 & Site.ID == 2008)
pm1sub <- subset(cnt1, County.Code == 63 & Site.ID == 2008)
pm0sub
x0sub <- pm0sub$Sample.Value
x1sub <- pm1sub$Sample.Value
dates0 <- as.Date(as.character(pm0sub$Date), '%Y%m%d')
dates1 <- as.Date(as.character(pm1sub$Date), '%Y%m%d')
par(mfrow = c(1,2), mar = c(4,4,2,1))
plot(dates0, x0sub, pch = 20)
abline(median(x0sub, na.rm = TRUE), lwd = 2)
abline(a = median(x0sub, na.rm = TRUE), lwd = 2)
abline(a = median(x0sub$, na.rm = TRUE), lwd = 2)
x0sub
abline(h = median(x0sub$, na.rm = TRUE), lwd = 2)
abline(h = median(x0sub, na.rm = TRUE), lwd = 2)
plot(dates1, x1sub, pch = 20)
abline(h = median(x1sub, na.rm = TRUE), lwd = 2)
rng <- range(x0sub,x1sub, na.rm = TRUE)
ylim = rng
rng
mn0 <- with(pm0, tapply(Sample.Value, State.Code, mean, na.rm = TRUE))
str(mn0)
mn1 <- with(pm1, tapply(Sample.Value, State.Code, mean, na.rm = TRUE))
str(mn1)
summary(mn0)
summary(mn1)
d0 <- data.frame(state = names(mn0))
d0
d0 <- data.frame(state = names(mn0), mean = mn0)
d1 <- data.frame(state = names(mn1), mean = mn0)
d1 <- data.frame(state = names(mn1), mean = mn1)
merge(d0, d1, 'state')
mrg <- merge(d0, d1, by = 'state')
dim(mrg)
head(mrg)
with(mrg, plot(rep(1,52), mrg[,2], xlim = c(0.5,2.5)))
with(mrg, plot(rep(2,52), mrg[,3]))
with(mrg, plot(rep(2,52), mrg[,3]), xlim = c(0.5,2.5))
with(mrg, points(rep(2,52), mrg[,3]))
with(mrg, plot(rep(1,52), mrg[,2], xlim = c(0.5,2.5)))
with(mrg, points(rep(2,52), mrg[,3]))
segments(rep(1,52), mrg[,2], rep(2,52), mrg[,3])
mrg[mrg$mean.x < mrg.mean.y, ]
mrg[mrg$mean.x < mrg$mean.y, ]
nei <- readRDS("summarySCC_PM25.rds")
scc <- readRDS("Source_Classification_Code.rds")
head(nei)
year <- nei$year
pm25 <- nei$Emissions
boxplot(year,pm25)
split(nei, list = year)
?split
split(nei, year)
pm99 <- nei[year==1999,]
pm02 <- nei[year==2002,]
pm05 <- nei[year==2005,]
pm08 <- nei[year==2008,]
pm99
head(nei)
pm99 <- nei[year==1999,Emissions]
pm02 <- nei[year==2002,Emissions]
pm05 <- nei[year==2005,Emissions]
pm08 <- nei[year==2008,Emissions]
pm99 <- nei[year==1999,4]
pm02 <- nei[year==2002,4]
pm05 <- nei[year==2005,4]
pm08 <- nei[year==2008,4]
boxplot(pm99)
boxplot(log10(pm99))
boxplot(log10(pm99))
boxplot(log10(pm99, na.rm = TRUE))
boxplot(log10(pm99), na.rm = TRUE)
boxplot(1,log10(pm99))
boxplot(log10(pm99),log10(pm99))
boxplot(log10(pm99), log10(pm22), log10(pm05), log10(pm98))
boxplot(log10(pm99), log10(pm02), log10(pm05), log10(pm08))
boxplot(log10(pm99), log10(pm02), log10(pm05), log10(pm08), xlim = c(-10, 5))
boxplot(log10(pm99), log10(pm02), log10(pm05), log10(pm08), ylim = c(-10, 5))
boxplot(log10(pm99), log10(pm02), log10(pm05), log10(pm08), ylim = c(-10, 5), ylab = log10(pm25))
boxplot(log10(pm99), log10(pm02), log10(pm05), log10(pm08), ylim = c(-10, 5), ylab = 'log10(pm25)')
boxplot(log10(pm99), log10(pm02), log10(pm05), log10(pm08), ylim = c(-10, 5))
boxplot(log10(pm99), log10(pm02), log10(pm05), log10(pm08), ylim = c(-10, 5))
boxplot(log10(pm25) ~ year, ylim = c(-10, 5))
png(filename="plot1.png",width=480, height=480)
boxplot(log10(pm25) ~ year, ylim = c(-10, 5))
dev.off()
head(nei)
bc <- nei[fips == "24510", ]
bc <- nei[fips == "24510", ]
str(nei)
bc <- nei[nei$fips == "24510", ]
head(bc)
year_bc <- bc$year
pm25_bc <- bc$Emissions
year_bc
boxplot(log10(pm25_bc) ~ year_bc)
png(filename="plot2.png",width=480, height=480)
boxplot(log10(pm25_bc) ~ year_bc)
dev.off()
head(bc)
type_bc <- bc$type
ggplot(bc, aes(x=year, y=Emissions,fill=type))+geom_boxplt()
library(ggplot2)
ggplot(bc, aes(x=year, y=Emissions,fill=type))+geom_boxplt()
ggplot(bc, aes(x=year, y=Emissions,fill=type))+geom_boxplot()
ggplot(bc, aes(x=year, y=lot10(Emissions),fill=type))+geom_boxplot()
ggplot(bc, aes(x=year, y=lot10(Emissions),fill=type))+geom_boxplot()
ggplot(bc, aes(x=year, y=log10(Emissions),fill=type))+geom_boxplot()
ggplot(bc, aes(x=year, y=log10(Emissions))+geom_boxplot()
ggplot(bc, aes(x=year, y=log10(Emissions))+geom_boxplot()
ggplot(bc, aes(x=year, y=log10(Emissions))+geom_boxplot()
ggplot(bc, aes(x=year, y=log10(Emissions))+geom_boxplot()
ggplot(bc, aes(x=year, y=log10(Emissions)) + geom_boxplot()
ggplot(bc, aes(x=year, y=log10(Emissions))) + geom_boxplot()
ggplot(bc, aes(x=year, y=log10(Emissions))) + geom_boxplot()
ggplot(bc, aes(x=year, y=log10(Emissions)), fill = year) + geom_boxplot()
ggplot(bc, aes(x=year, y=log10(Emissions)), fill = t) + geom_boxplot()
ggplot(bc, aes(x=year, y=log10(Emissions)), fill = type.convert()) + geom_boxplot()
ggplot(bc, aes(x=year, y=log10(Emissions)), fill = type) + geom_boxplot()
ggplot(bc, aes(x=year, y=log10(Emissions), fill = year)) + geom_boxplot()
ggplot(bc, aes(x=year, y=log10(Emissions), fill = type)) + geom_boxplot()
ggplot(bc, aes(x=year, y=log10(Emissions), fill = year)) + geom_boxplot()
ggplot(bc, aes(x=year, y=log10(Emissions))) + geom_boxplot(aes(fill=year))
as.factor(bc$year)
str(bc)
bc$year <- as.factor(bc$year)
str(bc)
ggplot(bc, aes(x=year, y=log10(Emissions))) + geom_boxplot(aes(fill=year))
g <- ggplot(bc, aes(x=year, y=log10(Emissions)))
g +     geom_boxplot(aes(fill=year)) +
facet_wrap(~ type)
png(filename="plot3.png",width=480, height=480)
g +
geom_boxplot(aes(fill=year)) +
facet_wrap(~ type)
dev.off()
scc
head(scc)
str(scc)
scc$SCC.Level.One
unique(scc$SCC.Level.One)
head(nei)
unique(scc$SCC.Level.Two)
unique(scc$SCC.Level.One)
head(nei)
scc
head(scc)
com <- left_join(nei, scc, by = SCC)
library(dplyr)
com <- left_join(nei, scc, by = SCC)
head(scc)
head(nei)
?left_join
com <- left_join(nei, scc, by = 'SCC')
com
str(com)
unique(com$SCC.Level.One)
unique(scc$SCC.Level.One)
str(nei)
str(scc)
nei$SCC <- as.factor(nei$SCC)
com <- left_join(nei, scc, by = 'SCC')
nei$SCC <- as.factor(nei$SCC)
nei$year <- as.factor(nei$year)
unique(com$SCC.Level.One)
head(nei)
str(nei)
str(scc)
str(com)
tail(com)
com_coal <- com[SCC.Level.One %in%
c('External Combustion Boilers',
'Internal Combustion Engines',
'Stationary Source Fuel Combustion'),]
com_coal <- com[com$SCC.Level.One %in%
c('External Combustion Boilers',
'Internal Combustion Engines',
'Stationary Source Fuel Combustion'),]
com_coal
g <- ggplot(com_coal, aes(x=year, y=log10(Emissions)))
g + geom_boxplot(aes(fill=year))
nei$year <- as.factor(nei$year)
com <- left_join(nei, scc, by = 'SCC')
com_coal <- com[com$SCC.Level.One %in%
c('External Combustion Boilers',
'Internal Combustion Engines',
'Stationary Source Fuel Combustion'),]
g <- ggplot(com_coal, aes(x=year, y=log10(Emissions)))
g + geom_boxplot(aes(fill=year))
png(filename="plot3.png",width=480, height=480)
g + geom_boxplot(aes(fill=year))
dev.off()
#Of the four types of sources indicated by the \color{red}{\verb|type|}type (point, nonpoint, onroad, nonroad) variable
#which of these four sources have seen decreases in emissions from 1999–2008 for Baltimore City?
bc <- nei[nei$fips == "24510", ]
g <- ggplot(bc, aes(x=year, y=log10(Emissions)))
g +
geom_boxplot(aes(fill=year)) +
facet_wrap(~ type)
png(filename="plot3.png",width=480, height=480)
g +
geom_boxplot(aes(fill=year)) +
facet_wrap(~ type)
dev.off()
#Decreased
#how have emissions from coal combustion-related sources changed from 1999–2008?
com <- left_join(nei, scc, by = 'SCC')
com_coal <- com[com$SCC.Level.One %in%
c('External Combustion Boilers',
'Internal Combustion Engines',
'Stationary Source Fuel Combustion'),]
g <- ggplot(com_coal, aes(x=year, y=log10(Emissions)))
g + geom_boxplot(aes(fill=year))
png(filename="plot4.png",width=480, height=480)
g + geom_boxplot(aes(fill=year))
dev.off()
#Stable
str(com)
head(com)
unique(com$SCC.Level.One)
com_bc_motor <- com[com$SCC.Level.One = 'Mobile Sources'
& com$fips == "24510",]
com_bc_motor <- com[com$SCC.Level.One = 'Mobile Sources' & com$fips == "24510",]
com_bc_motor
com_bc_motor <- com[com$SCC.Level.One = 'Mobile Sources' & com$fips == "24510",]
com_bc_motor <- com[com$SCC.Level.One == 'Mobile Sources' & com$fips == "24510",]
com_bc_motor
g <- ggplot(com_bc_motor, aes(x=year, y=log10(Emissions)))
g + geom_boxplot(aes(fill=year))
png(filename="plot5.png",width=480, height=480)
g + geom_boxplot(aes(fill=year))
dev.off()
com_los_motor <- com[com$SCC.Level.One == 'Mobile Sources' & com$fips == "06037",]
g <- ggplot(com_bc_motor, aes(x=year, y=log10(Emissions)))
g + geom_boxplot(aes(fill=year)) +
facet_wrap(~ fips)
bc <- nei[nei$fips == "24510", ]
g <- ggplot(bc, aes(x=year, y=log10(Emissions)))
g + geom_boxplot(aes(fill=year)) +
facet_wrap(~ type)
png(filename="plot3.png",width=480, height=480)
g + geom_boxplot(aes(fill=year)) +
facet_wrap(~ type)
dev.off()
com_bc_motor <- com[com$SCC.Level.One == 'Mobile Sources' & com$fips == "24510",]
com_los_motor <- com[com$SCC.Level.One == 'Mobile Sources' & com$fips == "06037",]
g <- ggplot(com_bc_motor, aes(x=year, y=log10(Emissions)))
g + geom_boxplot(aes(fill=year)) +
facet_wrap(~ fips)
bc_los_motor <- com[com$SCC.Level.One == 'Mobile Sources' & com$fips %in% c("24510", "06037")]
g <- ggplot(bc_los_motor, aes(x=year, y=log10(Emissions)))
g + geom_boxplot(aes(fill=year)) +
facet_wrap(~ fips)
bc_los_motor <- com[com$SCC.Level.One == 'Mobile Sources' & com$fips %in% c("24510", "06037")]
bc_los_motor <- com[com$SCC.Level.One == 'Mobile Sources' & com$fips %in% c("24510","06037")]
bc_los_motor <- com[com$SCC.Level.One == 'Mobile Sources' & com$fips %in% c("24510","06037"),]
g <- ggplot(bc_los_motor, aes(x=year, y=log10(Emissions)))
g + geom_boxplot(aes(fill=year)) +
facet_wrap(~ fips)
?if_else
bc_los_motor$location <- if_else(fips == "24510", "Baltimore City", "Los Angeles County")
bc_los_motor$location <- if_else(bc_los_motor$fips == "24510", "Baltimore City", "Los Angeles County")
g <- ggplot(bc_los_motor, aes(x=year, y=log10(Emissions)))
g + geom_boxplot(aes(fill=year)) +
facet_wrap(~ location)
png(filename="plot5.png",width=480, height=480)
g + geom_boxplot(aes(fill=year)) +
facet_wrap(~ location)
dev.off()
com <- left_join(nei, scc, by = 'SCC')
com_bc_motor <- com[com$SCC.Level.One == 'Mobile Sources' & com$fips == "24510",]
g <- ggplot(com_bc_motor, aes(x=year, y=log10(Emissions)))
g + geom_boxplot(aes(fill=year))
png(filename="plot5.png",width=480, height=480)
g + geom_boxplot(aes(fill=year))
dev.off()
bc_los_motor <- com[com$SCC.Level.One == 'Mobile Sources' & com$fips %in% c("24510","06037"),]
bc_los_motor$location <- if_else(bc_los_motor$fips == "24510", "Baltimore City", "Los Angeles County")
g <- ggplot(bc_los_motor, aes(x=year, y=log10(Emissions)))
g + geom_boxplot(aes(fill=year)) +
facet_wrap(~ location)
png(filename="plot6.png",width=480, height=480)
g + geom_boxplot(aes(fill=year)) +
facet_wrap(~ location)
dev.off()
